# –ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏

## –î–∞—Ç–∞: 11.12.2025

### –ö–æ–º–º–∏—Ç: e8c7e14 - "fix: improve browser stability and authorization flow"

**–í–ê–ñ–ù–û: –†–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è –¥–æ –ø—Ä–æ–±–ª–µ–º –±—ã–ª–∞ –Ω–∞ –∫–æ–º–º–∏—Ç–µ: `7301b2b` ("ready download reports")**

–î–ª—è –æ—Ç–∫–∞—Ç–∞ –∫ —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
git reset --hard 7301b2b
```

---

## –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç–µ–∫—É—â–µ–º –∫–æ–º–º–∏—Ç–µ (e8c7e14):

### 1. `.cursor/cursorrules.mdc`
**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: **–ù–ï –£–î–ê–õ–Ø–¢–¨ –ü–†–û–§–ò–õ–ò –ë–†–ê–£–ó–ï–†–ê –±–µ–∑ —è–≤–Ω–æ–≥–æ –æ–¥–æ–±—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
- –ü—Ä–æ—Ñ–∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, –∏—Ö —É–¥–∞–ª–µ–Ω–∏–µ = –ø–æ—Ç–µ—Ä—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü—Ä–∏—á–∏–Ω–∞:**
- –†–∞–Ω–µ–µ –ø—Ä–æ—Ñ–∏–ª—å `yandex_automation_profile` –±—ã–ª —É–¥–∞–ª—ë–Ω –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ –ø–æ—Ç–µ—Ä–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

### 2. `src/agents/browser_agent.py`
**–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**

#### 2.1. CDP –∫–æ–º–∞–Ω–¥–∞ (—Å—Ç—Ä–æ–∫–∏ ~124-133)
**–î–æ:**
```python
self.driver.execute_cdp_cmd("Page.setDownloadBehavior", {
    "behavior": "allow",
    "downloadPath": str(self.downloads_dir.absolute())
})
logger.success("‚úì –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—â–µ–Ω")
```

**–ü–æ—Å–ª–µ:**
```python
logger.success("‚úì –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—â–µ–Ω")

try:
    self.driver.execute_cdp_cmd("Page.setDownloadBehavior", {
        "behavior": "allow",
        "downloadPath": str(self.downloads_dir.absolute())
    })
    logger.info(f"‚úì –ü–∞–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è: {self.downloads_dir.absolute()}")
except Exception as cdp_error:
    logger.warning(f"‚ö† –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–ø–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ CDP: {cdp_error}")
    logger.info("–ë—Ä–∞—É–∑–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–ø–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- CDP –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∑—ã–≤–∞–ª–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É WB
- –û–±–µ—Ä–Ω—É–ª–∏ –≤ try-except –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–±–æ–µ–≤

#### 2.2. –ü—Ä–æ—Ñ–∏–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (—Å—Ç—Ä–æ–∫–∏ ~78-91)
**–î–æ:**
```python
if self.settings.yandex_user_data_dir and self.settings.yandex_profile_name:
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ .env
    ...
else:
    # –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –≤ –ø—Ä–æ–µ–∫—Ç–µ
    ...
```

**–ü–æ—Å–ª–µ:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
automation_profile = Path("./yandex_automation_profile").resolve()
automation_profile.mkdir(parents=True, exist_ok=True)

options.add_argument(f'--user-data-dir={str(automation_profile.absolute())}')
options.add_argument('--profile-directory=Default')
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –í–µ—Ä–Ω—É–ª–∏ –ª–æ–≥–∏–∫—É –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
- –≠—Ç–æ –±—ã–ª–æ –≤ —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏ (–∫–æ–º–º–∏—Ç 7301b2b)

#### 2.3. –ó–∞–¥–µ—Ä–∂–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ ~1025-1027)
**–î–æ:**
```python
time.sleep(8)  # –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
```

**–ü–æ—Å–ª–µ:**
```python
time.sleep(3)  # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –£–±—Ä–∞–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ–¥–ª—è–ª–∏ —Ä–∞–±–æ—Ç—É

#### 2.4. –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–º–µ—Ä–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ ~411-434)
**–î–æ:**
```python
submit_button = WebDriverWait(self.driver, self.settings.element_wait_timeout).until(
    EC.element_to_be_clickable((By.CSS_SELECTOR, 'button[data-testid="submit-phone-button"]'))
)
```

**–ü–æ—Å–ª–µ:**
```python
try:
    submit_button = WebDriverWait(self.driver, 5).until(
        EC.element_to_be_clickable((By.CSS_SELECTOR, 'button[data-testid="submit-phone-button"]'))
    )
except TimeoutException:
    # –ò—â–µ–º –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é —Å—Ç—Ä–µ–ª–∫–∏ (–∫–∞–∫ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ)
    try:
        submit_button = WebDriverWait(self.driver, 5).until(
            EC.element_to_be_clickable((By.CSS_SELECTOR, 'img[alt=""][class*="FormPhoneInputBorderless__image"]'))
        )
    except TimeoutException:
        submit_button = WebDriverWait(self.driver, 5).until(
            EC.element_to_be_clickable((By.XPATH, '//img[contains(@class, "FormPhoneInputBorderless__image")]/parent::button'))
        )
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º –∏–∑ —Ñ–∞–π–ª–∞ `algorithm`
- –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏

#### 2.5. –ü–æ–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ ~442, ~484)
**–î–æ:**
```python
code_input = WebDriverWait(self.driver, self.settings.element_wait_timeout).until(
    EC.presence_of_element_located((By.CSS_SELECTOR, 'input[type="numeric"]'))
)
```

**–ü–æ—Å–ª–µ:**
```python
code_input = WebDriverWait(self.driver, self.settings.element_wait_timeout).until(
    EC.presence_of_element_located((By.CSS_SELECTOR, 'div.FormTextInput__input-f6fPmoYx4c input[type="numeric"], input[type="numeric"]'))
)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –°–µ–ª–µ–∫—Ç–æ—Ä –∏–∑ —Ñ–∞–π–ª–∞ `algorithm` –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ–ª–µ–π

---

### 3. –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö
**–ò–∑–º–µ–Ω–µ–Ω—ã:**
- `data/11.12.2025/*.xlsx` - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç—á—ë—Ç–æ–≤
- `downloads/.gitkeep`, `pages_code/.gitkeep` - —Å–ª—É–∂–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã

**–î–µ–π—Å—Ç–≤–∏–µ:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞

---

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ó–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞ —Å –ø—Ä–æ—Ñ–∏–ª–µ–º `yandex_automation_profile`
- CDP –∫–æ–º–∞–Ω–¥–∞ –æ–±—ë—Ä–Ω—É—Ç–∞ –≤ try-except (–Ω–µ –∫—Ä–∞—à–∏—Ç –±—Ä–∞—É–∑–µ—Ä)
- –ê–ª–≥–æ—Ä–∏—Ç–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—ë–Ω –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É `algorithm`
- –ü—Ä–æ—Ñ–∏–ª—å –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
- –ë—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É WB
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

### üîÑ –î–ª—è –æ—Ç–∫–∞—Ç–∞ –∫ —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏:
```bash
git reset --hard 7301b2b
```

### üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã WB
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è)
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –æ—Ç—á—ë—Ç–æ–≤

---

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å git:

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏:
```bash
git log --oneline -10
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–º–º–∏—Ç–µ:
```bash
git show e8c7e14
```

### –û—Ç–∫–∞—Ç –∫ —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏ (7301b2b):
```bash
git reset --hard 7301b2b
```

### –û—Ç–∫–∞—Ç –∫ –ª—é–±–æ–º—É –∫–æ–º–º–∏—Ç—É:
```bash
git reset --hard <commit-hash>
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```bash
git diff 7301b2b..e8c7e14
```

